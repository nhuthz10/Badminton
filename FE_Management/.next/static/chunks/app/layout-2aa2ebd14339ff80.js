(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{67095:function(e,n,r){Promise.resolve().then(r.t.bind(r,75326,23)),Promise.resolve().then(r.t.bind(r,12731,23)),Promise.resolve().then(r.bind(r,77999))},77999:function(e,n,r){"use strict";r.d(n,{default:function(){return y}});var t=r(57437),o=r(21159),s=r(57818),i=r(7570),a=r(87029),c=r(34036),u=r(5574),l=r(72791),h=r(34781),f=r(55922),d=r(32141),p=r(32416),g={storage:(0,h.Z)("local"),stateReconciler:l.Z},m=(0,a._)((0,i._)({},g),{key:"user",whitelist:["login","userInfo","favourites","cartId"]}),v=(0,c.xC)({reducer:{user:(0,u.OJ)(m,f.ZP),pagination:d.ZP,admin:p.ZP},middleware:function(e){return e({serializableCheck:{ignoredActions:[u._P,u.I2,u.E7,u.ex,u.e,u.Nz]}})}}),P=(0,u.p5)(v),k=r(33814),_=r(12784),b=r(61943),x=r(11735),j=r(15149),w=r(49714),C=r(70766),I=function(e){var n,r,s=e.children,i=(0,o.I0)(),a=!1,c=[],u=function(e){c.push(e)},l=function(e){c.forEach(function(n){return n(e)}),c=[]},h=(n=(0,b._)(function(){var e,n,r;return(0,x.Jh)(this,function(t){switch(t.label){case 0:if(a)return[3,5];a=!0,t.label=1;case 1:return t.trys.push([1,3,,4]),e=localStorage.getItem("refresh_token"),[4,(0,C.a5)(e)];case 2:return n=t.sent(),localStorage.setItem("access_token",n.access_token),a=!1,l(n.access_token),[2,n.access_token];case 3:throw r=t.sent(),a=!1,console.error("Failed to refresh token",r),i((0,f.ni)()),k.Am.error("Phi\xean đăng nhập đ\xe3 hết hạn"),r;case 4:return[3,6];case 5:return[2,new Promise(function(e){u(function(n){e(n)})})];case 6:return[2]}})}),function(){return n.apply(this,arguments)});return j.v.interceptors.request.use((r=(0,b._)(function(e){var n,r,t,o,s,a;return(0,x.Jh)(this,function(c){switch(c.label){case 0:if(n=localStorage.getItem("access_token"),r=localStorage.getItem("refresh_token"),!n||!r)return i((0,f.ni)()),k.Am.error("Phi\xean đăng nhập đ\xe3 hết hạn"),[2,Promise.reject("No tokens available")];if(t=new Date,o=(0,w.o)(n),s=(0,w.o)(r),!((null==o?void 0:o.exp)<t.getTime()/1e3))return[3,7];if(!((null==s?void 0:s.exp)>t.getTime()/1e3))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,h()];case 2:return a=c.sent(),e.headers.Authorization="Bearer ".concat(a),[2,e];case 3:return[2,Promise.reject(c.sent())];case 4:return[3,6];case 5:return i((0,f.ni)()),k.Am.error("Phi\xean đăng nhập đ\xe3 hết hạn"),[2,Promise.reject("Refresh token expired")];case 6:return[3,8];case 7:return e.headers.Authorization="Bearer ".concat(n),[2,e];case 8:return[2]}})}),function(e){return r.apply(this,arguments)}),function(e){return Promise.reject(e)}),(0,t.jsx)(t.Fragment,{children:s})};r(44193);var Z=(0,s.default)(function(){return r.e(4504).then(r.bind(r,14504)).then(function(e){return e.PersistGate})},{loadableGenerated:{webpack:function(){return[14504]}},ssr:!1}),y=function(e){var n=e.children;return(0,t.jsxs)(o.zt,{store:v,children:[(0,t.jsx)(Z,{loading:null,persistor:P,children:(0,t.jsx)(_.Z,{children:(0,t.jsx)(I,{children:n})})}),(0,t.jsx)(k.Ix,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark",style:{fontSize:"1.8rem"}})]})}},12784:function(e,n,r){"use strict";r.d(n,{s:function(){return c}});var t=r(47002),o=r(57437),s=r(45040),i=r(2265),a=(0,i.createContext)(null),c=function(){return(0,i.useContext)(a)};n.Z=function(e){var n=e.children,r=(0,t._)((0,i.useState)(null),2),c=r[0],u=r[1];return(0,i.useEffect)(function(){var e=(0,s.io)("http://localhost:8080");return u(e),function(){e.disconnect()}},[]),(0,o.jsx)(a.Provider,{value:c,children:n})}},32141:function(e,n,r){"use strict";r.d(n,{A6:function(){return o}});var t=(0,r(34036).oM)({name:"pagination",initialState:{page:1},reducers:{handleChangePage:function(e,n){e.page=n.payload}}}),o=t.actions.handleChangePage;n.ZP=t.reducer},12731:function(){}},function(e){e.O(0,[2171,9931,8436,1159,5040,6276,2416,2971,7023,1744],function(){return e(e.s=67095)}),_N_E=e.O()}]);